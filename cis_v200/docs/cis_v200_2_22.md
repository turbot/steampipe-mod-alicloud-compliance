## Description

Real-time monitoring of API calls can be achieved by directing ActionTrail Logs to Log Service and establishing corresponding query and alarms. Security Groups are a stateful packet filter that controls ingress and egress traffic within a VPC. It is recommended that a query and alarm be established for changes to Security Groups.

## Remediation

Perform the following to ensure the log monitoring and alerts are set up for security group changes:

1. Logon to [SLS Console](https://sls.console.aliyun.com/).
2. Click `Log Service Audit Service` in the navigation pane.
3. Go to `Access to Cloud Products > Global Configuration` page.
   - Select a location of project for logs.
   - Check the `Action Trail` and configure a proper number of days.
   - Click `Save` to save the changes.
4. Go to `Access to Cloud Products > Global Configurations` click `Central Project`.
5. Select `Log Management > Actiontrail Log`.
6. In the search/analytics console, input the following query:

```bash
("event.eventName": CreateSecurityGroup or "event.eventName": AuthorizeSecurityGroup or "event.eventName": AuthorizeSecurityGroupEgress or "event.eventName": RevokeSecurityGroup or "event.eventName": RevokeSecurityGroupEgress or "event.eventName": JoinSecurityGroup or "event.eventName": LeaveSecurityGroup or "event.eventName": DeleteSecurityGroup or "event.eventName": ModifySecurityGroupPolicy) | select count(1) as cnt
```

7. Create a dashboard and set alert for the query result.

### Default Value:

The monitoring dashboard and alert is not set by default.